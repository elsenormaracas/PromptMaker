<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>TERMINAL_PROMPT_V1</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap');

        :root {
            --green: #33ff33;
            --green-glow: rgba(51, 255, 51, 0.4);
            --bg: #0a0a0a;
        }

        body {
            background-color: #050505;
            color: var(--green);
            font-family: 'Fira Code', monospace;
            margin: 0;
            overflow: hidden; /* Pour l'effet d'écran */
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
        }

        /* --- EFFET ÉCRAN COURBÉ --- */
        .crt-monitor {
            width: 95vw;
            height: 90vh;
            max-width: 900px;
            background: var(--bg);
            position: relative;
            overflow: hidden;
            border: 10px solid #222;
            border-radius: 50px / 25px;
            box-shadow: 0 0 50px rgba(0,0,0,1), inset 0 0 100px rgba(0,255,0,0.05);
            display: flex;
            flex-direction: column;
            padding: 30px;
            box-sizing: border-box;
        }

        /* Scanlines & Flicker */
        .crt-monitor::before {
            content: " ";
            display: block;
            position: absolute;
            top: 0; left: 0; bottom: 0; right: 0;
            background: linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.25) 50%), 
                        linear-gradient(90deg, rgba(255, 0, 0, 0.06), rgba(0, 255, 0, 0.02), rgba(0, 0, 255, 0.06));
            z-index: 10;
            background-size: 100% 4px, 3px 100%;
            pointer-events: none;
        }

        /* Effet de lueur (Glow) */
        .glow-text {
            text-shadow: 0 0 8px var(--green-glow);
        }

        header { border-bottom: 1px solid var(--green); margin-bottom: 20px; padding-bottom: 10px; }
        
        .view { display: none; flex-direction: column; height: 100%; }
        .view.active { display: flex; }

        .prompt-display { font-size: 1.2rem; border: 1px dashed var(--green); padding: 20px; margin: 20px 0; background: rgba(51, 255, 51, 0.05); }

        textarea {
            flex-grow: 1;
            background: transparent;
            color: var(--green);
            border: 1px solid var(--green);
            padding: 15px;
            font-family: 'Fira Code', monospace;
            font-size: 1.1rem;
            text-shadow: 0 0 5px var(--green-glow);
            resize: none;
            outline: none;
            box-shadow: inset 0 0 10px var(--green-glow);
        }

        button {
            background: var(--green);
            color: black;
            border: none;
            padding: 10px 20px;
            font-family: 'Fira Code', monospace;
            font-weight: bold;
            cursor: pointer;
            text-transform: uppercase;
            margin: 5px;
        }

        button:hover { background: white; box-shadow: 0 0 15px white; }
        button.secondary { background: transparent; color: var(--green); border: 1px solid var(--green); }

        .timer { font-size: 2rem; text-align: right; }
        .stats-line { font-size: 0.8rem; margin-top: 10px; }
        
        ::-webkit-scrollbar { width: 8px; }
        ::-webkit-scrollbar-thumb { background: var(--green); }
    </style>
</head>
<body>

<div class="crt-monitor">
    <header class="glow-text">
        > PROMPT_MAKER_OS [Version 1.0.4] <br>
        > (c) 1986 RE-WRITE CORP.
        <div class="stats-line" id="count-display">PROMPTS_LOADED: 0</div>
    </header>

    <div id="view-home" class="view active">
        <div id="category-label" style="text-decoration: underline;">SYSTEM_READY</div>
        <div id="prompt-text" class="prompt-display glow-text">APP_IDLE: ATTENTE_COMMANDE...</div>
        <div>
            <button onclick="generatePrompt()">[ EXEC_RANDOM_PROMPT ]</button>
            <button onclick="startSession()" id="start-btn" style="display:none;">[ INITIALISER_SEQUENCE_ECRITURE ]</button>
        </div>
    </div>

    <div id="view-writing" class="view">
        <div class="timer glow-text" id="timer-display">10:00</div>
        <div id="writing-prompt-ref" style="font-size: 0.8rem; margin-bottom: 10px; opacity: 0.8;"></div>
        <textarea id="story-input" spellcheck="false" oninput="countWords()"></textarea>
        <div class="stats-line">
            MOTS: <span id="word-count">0</span> | FOCUS_MODE: ON
            <button onclick="finishEarly()" class="secondary" style="float:right;">[ FORCE_SAVE ]</button>
        </div>
    </div>

    <div id="view-history" class="view">
        <h2 class="glow-text"> ARCHIVES_DATA </h2>
        <div id="history-list" style="overflow-y: auto; flex-grow: 1;"></div>
        <div style="margin-top: 20px;">
            <button onclick="showView('view-home')">[ RETOUR ]</button>
        </div>
    </div>

    <footer style="margin-top: 20px;">
        <button onclick="showHistory()" class="secondary">/DIR/ARCHIVES</button>
    </footer>
</div>

<script>
    // COLLE TES BLOCS ICI (500 PROMPTS)
    const promptsBase = [
        { type: "STORY_START", content: "L'ordinateur m'a répondu. Pas avec du code, mais avec un poème." }
    ];

    let currentPrompt = null;
    let timerInterval = null;
    let timeLeft = 600;

    window.onload = () => {
        document.getElementById('count-display').innerText = `PROMPTS_LOADED: ${promptsBase.length}`;
    };

    function showView(viewId) {
        document.querySelectorAll('.view').forEach(v => v.classList.remove('active'));
        document.getElementById(viewId).classList.add('active');
    }

    function generatePrompt() {
        const randomIndex = Math.floor(Math.random() * promptsBase.length);
        currentPrompt = promptsBase[randomIndex];
        document.getElementById('category-label').innerText = `TYPE: ${currentPrompt.type}`;
        document.getElementById('prompt-text').innerText = `> ${currentPrompt.content}`;
        document.getElementById('start-btn').style.display = 'inline-block';
    }

    function startSession() {
        showView('view-writing');
        document.getElementById('writing-prompt-ref').innerText = `PROMPT: ${currentPrompt.content}`;
        document.getElementById('story-input').value = "";
        document.getElementById('story-input').focus();
        startTimer();
    }

    function countWords() {
        const text = document.getElementById('story-input').value.trim();
        document.getElementById('word-count').innerText = text ? text.split(/\s+/).length : 0;
    }

    function startTimer() {
        timeLeft = 600;
        updateTimerDisplay();
        timerInterval = setInterval(() => {
            timeLeft--;
            updateTimerDisplay();
            if (timeLeft <= 0) saveStory();
        }, 1000);
    }

    function updateTimerDisplay() {
        const mins = Math.floor(timeLeft / 60);
        const secs = timeLeft % 60;
        document.getElementById('timer-display').innerText = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }

    function finishEarly() { if(confirm("SAUVEGARDER_DONNEES?")) saveStory(); }

    function saveStory() {
        clearInterval(timerInterval);
        const text = document.getElementById('story-input').value;
        if(text.length < 5) return showView('view-home');

        const entry = {
            date: new Date().toLocaleDateString('fr-FR'),
            prompt: currentPrompt.content,
            text: text
        };

        const history = JSON.parse(localStorage.getItem('pMaker_retro') || '[]');
        history.unshift(entry);
        localStorage.setItem('pMaker_retro', JSON.stringify(history));
        showHistory();
    }

    function showHistory() {
        showView('view-history');
        const list = document.getElementById('history-list');
        const history = JSON.parse(localStorage.getItem('pMaker_retro') || '[]');
        list.innerHTML = "";
        history.forEach(item => {
            list.innerHTML += `<div style="border: 1px solid var(--green); padding: 10px; margin-bottom: 10px;">
                <small>${item.date}</small><br>
                <strong>> ${item.prompt}</strong><br>
                <p>${item.text}</p>
            </div>`;
        });
    }
</script>
</body>
</html>
