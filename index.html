<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" href="data:image/svg+xml,<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 100 100'><text y='.9em' font-size='90'>ðŸ’¾</text></svg>">
    <title>R3_WR1T3_STAT10N</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fira+Code:wght@400;700&display=swap');

        :root {
            /* Couleurs par dÃ©faut (Vert) */
            --p-color: #42ff71;
            --p-glow: rgba(66, 255, 113, 0.4);
            --bg-faded: #121412; 
        }

        /* ThÃ¨me Ambre */
        body.theme-amber {
            --p-color: #ffb000;
            --p-glow: rgba(255, 176, 0, 0.4);
            --bg-faded: #14110b;
        }

        /* ThÃ¨me Blanc */
        body.theme-white {
            --p-color: #e0e0e0;
            --p-glow: rgba(255, 255, 255, 0.3);
            --bg-faded: #161616;
        }

        body {
            background-color: #000;
            color: var(--p-color);
            font-family: 'Fira Code', monospace;
            margin: 0;
            height: 100vh;
            display: flex;
            justify-content: center;
            align-items: center;
            overflow: hidden;
            transition: color 0.3s ease;
        }

        .crt-monitor {
            width: 100vw; height: 100vh;
            background: var(--bg-faded);
            position: relative;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            padding: 5vw;
            box-sizing: border-box;
            transition: background 0.3s ease;
        }

        @media (min-width: 768px) {
            .crt-monitor { width: 95vw; height: 90vh; max-width: 1000px; border: 15px solid #1a1a1a; border-radius: 40px; padding: 40px; }
        }

        .crt-monitor::before {
            content: ""; position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: radial-gradient(circle at 50% 50%, rgba(255,255,255,0.02) 0%, transparent 80%),
                        linear-gradient(rgba(18, 16, 16, 0) 50%, rgba(0, 0, 0, 0.1) 50%);
            background-size: 100% 100%, 100% 3px;
            pointer-events: none; z-index: 20;
        }

        .noise-overlay {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            background: url("data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADIAAAAyBAMAAADsEZWCAAAAGFBMVEUAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAADeST97AAAAB3RSTlMAVVDu/v4AfZ3OAAAARElEQVQ4y2NgQAX8DIxgIAnGZ2AEAzEwHh0tGEiC8ZlQMBCPjhYMJMH4TCgYiEdHCwaSYHwmFAzEo6MFA0kwPhMKBuIRAFidGf9p99vjAAAAAElFTkSuQmCC");
            opacity: 0.08; pointer-events: none; z-index: 25; animation: noise 0.3s infinite;
        }

        @keyframes noise { 0% { transform: translate(0,0); } 50% { transform: translate(-0.5%, -0.5%); } 100% { transform: translate(0,0); } }

        .view-content { position: relative; z-index: 30; display: none; flex-direction: column; height: 100%; }
        .view-content.active { display: flex; }

        .glow-text { text-shadow: 0 0 10px var(--p-glow); }

        header { border-bottom: 1px solid var(--p-color); margin-bottom: 15px; font-size: 0.7rem; padding-bottom: 5px; display: flex; justify-content: space-between; }

        .prompt-display { 
            font-size: 1.1rem; border: 1px solid var(--p-color); padding: 15px; margin: 10px 0; 
            background: rgba(255, 255, 255, 0.02); flex-grow: 0; max-height: 40%; overflow-y: auto; 
        }

        textarea {
            flex-grow: 1; background: rgba(0,0,0,0.1); color: var(--p-color); border: 1px solid var(--p-color);
            padding: 12px; font-family: 'Fira Code', monospace; font-size: 1rem; resize: none; outline: none;
            text-shadow: 0 0 5px var(--p-glow); margin-bottom: 10px;
        }

        .btn-group { display: flex; flex-wrap: wrap; gap: 10px; }

        button {
            background: var(--p-color); color: #121412; border: none; padding: 15px 20px;
            font-family: 'Fira Code', monospace; font-weight: bold; cursor: pointer;
            text-transform: uppercase; flex: 1 1 140px; font-size: 0.9rem; transition: 0.2s;
        }

        button:active { transform: scale(0.95); }
        button.secondary { background: transparent; color: var(--p-color); border: 1px solid var(--p-color); }
        button.mini { padding: 5px 10px; font-size: 0.6rem; flex: none; }

        .timer { font-size: 2rem; text-align: center; margin-bottom: 10px; }

        @media (max-width: 480px) {
            header { font-size: 0.6rem; }
            .prompt-display { font-size: 1rem; padding: 10px; }
            button { padding: 12px 10px; font-size: 0.8rem; }
            .timer { font-size: 1.5rem; }
        }

        ::-webkit-scrollbar { width: 4px; }
        ::-webkit-scrollbar-thumb { background: var(--p-color); }
    </style>
</head>
<body>

<div class="crt-monitor">
    <div class="noise-overlay"></div>
    
    <header class="glow-text">
        <div>[ SYSTEM_READY ]</div>
        <button class="mini secondary" onclick="cycleTheme()">[ COLOR_CHG ]</button>
    </header>

    <div id="view-home" class="view-content active">
        <div id="prompt-text" class="prompt-display glow-text">
            > CHARGEMENT... PRÃŠT. LANCEZ UNE COMMANDE.
        </div>
        <div class="btn-group">
            <button onclick="generatePrompt()">[ GENERER_DEFI ]</button>
            <button onclick="startSession()" id="start-btn" style="display:none;">[ START ]</button>
        </div>
    </div>

    <div id="view-writing" class="view-content">
        <div class="timer glow-text" id="timer-display">10:00</div>
        <textarea id="story-input" spellcheck="false" oninput="countWords()" placeholder="Entrez du texte..."></textarea>
        <div class="btn-group">
            <button onclick="finishEarly()" class="secondary" style="flex:2;">[ SAVE_AND_EXIT ]</button>
            <div style="flex:1; text-align:right; font-size:0.8rem; align-self:center;">
                <span id="word-count">0</span> MOTS
            </div>
        </div>
    </div>

    <div id="view-history" class="view-content">
        <h2 class="glow-text" style="font-size: 1.2rem; display: flex; justify-content: space-between;"> 
            <span>> ARCHIVES</span>
            <button class="mini secondary" onclick="clearArchives()" style="color: #ff4757; border-color: #ff4757;">[ CLEAR_ALL ]</button>
        </h2>
        <div id="history-list" style="overflow-y: auto; flex-grow: 1; font-size: 0.85rem; border-top: 1px dashed var(--p-color); padding-top: 10px;"></div>
        <div style="margin-top: 10px;">
            <button onclick="showView('view-home')" style="width:100%;">[ RETURN ]</button>
        </div>
    </div>

    <footer style="margin-top: auto; padding-top: 10px;">
        <button onclick="showHistory()" class="secondary" style="width:100%; padding: 8px; font-size: 0.7rem;">/usr/bin/history</button>
    </footer>
</div>

<script>
    // COLLE TES 5 BLOCS ICI
    const promptsBase = [
           // TERMINE L'HISTOIRE
    { type: "Termine l'histoire", content: "L'ascenseur s'ouvrit sur un champ de blÃ© au lieu du parking souterrain. Une brise chaude caressa mon visage." },
    { type: "Termine l'histoire", content: "Le vieil antiquaire me tendit le miroir en disant : 'Attention, celui-ci ne reflÃ¨te que ce que vous avez perdu'." },
    { type: "Termine l'histoire", content: "J'ai trouvÃ© une clÃ© dans ma poche ce matin. Le problÃ¨me, c'est que je ne porte pas mon propre pantalon." },
    { type: "Termine l'histoire", content: "La pluie ne tombait pas au sol. Elle flottait Ã  dix centimÃ¨tres de la route, crÃ©ant un ocÃ©an suspendu." },
    { type: "Termine l'histoire", content: "Mon reflet dans la vitrine s'est arrÃªtÃ© pour allumer une cigarette alors que je continuais Ã  marcher." },
    { type: "Termine l'histoire", content: "Le message sur le rÃ©pondeur datait d'hier, mais la voix Ã©tait la mienne, me suppliant de ne pas ouvrir la porte." },
    { type: "Termine l'histoire", content: "Au milieu de la foule, tout le monde s'est soudainement figÃ©, sauf un petit garÃ§on qui me pointait du doigt." },
    { type: "Termine l'histoire", content: "Elle a ouvert la boÃ®te de Pandore moderne : une clÃ© USB trouvÃ©e dans le mÃ©tro avec son nom Ã©crit dessus." },
    { type: "Termine l'histoire", content: "Le chat a sautÃ© sur mes genoux et a murmurÃ© : 'On n'a plus beaucoup de temps, tu sais'." },
    { type: "Termine l'histoire", content: "Le billet de train indiquait une destination qui n'apparaissait sur aucune carte du monde connue." },
    { type: "Termine l'histoire", content: "Le peintre a retirÃ© le drap du portrait. Ce n'Ã©tait pas moi, mais ce Ã  quoi je ressemblerai dans 40 ans." },
    { type: "Termine l'histoire", content: "L'ombre de l'arbre au milieu du jardin ne suivait pas la course du soleil, elle pointait obstinÃ©ment vers la cave." },
    { type: "Termine l'histoire", content: "Il a croquÃ© dans la pomme et a soudainement entendu les pensÃ©es de tous les gens prÃ©sents dans la piÃ¨ce." },
    { type: "Termine l'histoire", content: "La radio s'est mise Ã  diffuser les informations du 14 juillet 2085. Le prÃ©sentateur semblait paniquÃ©." },
    { type: "Termine l'histoire", content: "En creusant pour planter ses rosiers, elle est tombÃ©e sur un coffret contenant son propre journal intime, terminÃ©." },

    // IDÃ‰ES / SCÃ‰NARIOS
    { type: "IdÃ©e", content: "Un astronaute revient sur Terre mais dÃ©couvre que l'humanitÃ© a disparu et a Ã©tÃ© remplacÃ©e par des versions vÃ©gÃ©tales de nous-mÃªmes." },
    { type: "IdÃ©e", content: "Ã‰cris un dialogue entre une personne qui veut vendre son Ã¢me et un dÃ©mon qui trouve que son Ã¢me n'a aucune valeur marchande." },
    { type: "IdÃ©e", content: "DÃ©cris une ville oÃ¹ le silence est une monnaie d'Ã©change : plus tu parles, plus tu t'appauvris." },
    { type: "IdÃ©e", content: "Deux robots de nettoyage discutent de la beautÃ© d'un coucher de soleil qu'ils ne peuvent pas voir car ils sont au sous-sol." },
    { type: "IdÃ©e", content: "Un homme dÃ©couvre qu'il est un personnage secondaire dans un roman policier et tente de devenir le protagoniste." },
    { type: "IdÃ©e", content: "Une lettre d'amour Ã©crite par une intelligence artificielle Ã  un grille-pain qui ne rÃ©pond jamais." },
    { type: "IdÃ©e", content: "Raconte la journÃ©e d'un super-hÃ©ros dont le seul pouvoir est de faire pousser les fleurs instantanÃ©ment." },
    { type: "IdÃ©e", content: "Un monde oÃ¹ chaque mensonge laisse une marque colorÃ©e sur la peau du menteur." },
    { type: "IdÃ©e", content: "DÃ©cris la rencontre entre un voyageur du temps du XIXe siÃ¨cle et un adolescent accro Ã  son smartphone." },
    { type: "IdÃ©e", content: "Une enquÃªte criminelle oÃ¹ le seul tÃ©moin est un perroquet qui ne parle qu'en rimes." },
    { type: "IdÃ©e", content: "Imagine une bibliothÃ¨que oÃ¹ l'on n'emprunte pas des livres, mais les souvenirs de personnes rÃ©elles." },
    { type: "IdÃ©e", content: "Le dernier homme sur Terre entend frapper Ã  sa porte. Il dÃ©cide de ne pas ouvrir et de prÃ©parer du thÃ©." },
    { type: "IdÃ©e", content: "Un enfant trouve une boussole qui n'indique pas le Nord, mais l'endroit oÃ¹ se cache son plus grand rÃªve." },
    { type: "IdÃ©e", content: "Raconte l'histoire d'un parfum qui permet de voyager dans le souvenir prÃ©cis liÃ© Ã  son odeur." },
    { type: "IdÃ©e", content: "Un dictionnaire magique oÃ¹ chaque mot que l'on efface disparaÃ®t de la rÃ©alitÃ©." },

    // TAGS (Inspiration libre)
    { type: "Tags", content: "âš“ Ancre, ðŸŒ«ï¸ Brouillard, ðŸŽ» Violon, ðŸ· Poison, ðŸ—ï¸ Grenier" },
    { type: "Tags", content: "ðŸš€ Station, ðŸª´ GÃ©ranium, ðŸ¤– Bug, ðŸ“¬ Lettre, â˜• Amertume" },
    { type: "Tags", content: "ðŸŽ­ Masque, ðŸŒ‘ Ã‰clipse, ðŸº Hurlement, â„ï¸ Neige, ðŸ•¯ï¸ Bougie" },
    { type: "Tags", content: "ðŸŽ¨ Palette, ðŸ–¼ï¸ Portrait, ðŸ›ï¸ MusÃ©e, ðŸ”¦ Vol, ðŸ§¤ Gants" },
    { type: "Tags", content: "ðŸŒŠ Ã‰pave, ðŸš Coquillage, ðŸ—ºï¸ Carte, ðŸ’Ž TrÃ©sor, ðŸ¦œ Perroquet" },
    { type: "Tags", content: "ðŸ§¶ Laine, ðŸˆ Chat, ðŸª‘ Fauteuil, ðŸ“š Grimoire, ðŸ’¨ Courant d'air" },
    { type: "Tags", content: "ðŸŒƒ NÃ©ons, ðŸœ Ramen, ðŸ® Lanterne, ðŸ§§ Secret, ðŸš• Pluie" },
    { type: "Tags", content: "ðŸŽ¹ Piano, ðŸŽ¼ Partition, ðŸ‘» FantÃ´me, ðŸ· Vin, ðŸšï¸ Manoir" },
    { type: "Tags", content: "ðŸŒ» Soleil, ðŸ§º Panier, ðŸ Abeille, ðŸ‘’ Chapeau, ðŸ¯ Miel" },
    { type: "Tags", content: "ðŸ‰ Ã‰caille, ðŸ—¡ï¸ Ã‰pÃ©e, ðŸ”ï¸ Sommet, ðŸ§— Corde, â„ï¸ Altitude" }

    ];

    let currentPrompt = null;
    let timerInterval = null;
    let timeLeft = 600;
    let currentTheme = 0; // 0: Vert, 1: Ambre, 2: Blanc

    function cycleTheme() {
        const body = document.body;
        currentTheme = (currentTheme + 1) % 3;
        body.classList.remove('theme-amber', 'theme-white');
        if (currentTheme === 1) body.classList.add('theme-amber');
        if (currentTheme === 2) body.classList.add('theme-white');
    }

    function showView(viewId) {
        document.querySelectorAll('.view-content').forEach(v => v.classList.remove('active'));
        document.getElementById(viewId).classList.add('active');
    }

    function generatePrompt() {
        const randomIndex = Math.floor(Math.random() * promptsBase.length);
        currentPrompt = promptsBase[randomIndex];
        document.getElementById('prompt-text').innerText = `> ${currentPrompt.content}`;
        document.getElementById('start-btn').style.display = 'block';
    }

    function startSession() {
        showView('view-writing');
        document.getElementById('story-input').value = "";
        document.getElementById('story-input').focus();
        startTimer();
    }

    function countWords() {
        const text = document.getElementById('story-input').value.trim();
        document.getElementById('word-count').innerText = text ? text.split(/\s+/).length : 0;
    }

    function startTimer() {
        timeLeft = 600;
        updateTimerDisplay();
        timerInterval = setInterval(() => {
            timeLeft--;
            updateTimerDisplay();
            if (timeLeft <= 0) saveStory();
        }, 1000);
    }

    function updateTimerDisplay() {
        const mins = Math.floor(timeLeft / 60);
        const secs = timeLeft % 60;
        document.getElementById('timer-display').innerText = `${mins}:${secs < 10 ? '0' : ''}${secs}`;
    }

    function finishEarly() { if(confirm("SAVE DATA?")) saveStory(); }

    function saveStory() {
        clearInterval(timerInterval);
        const text = document.getElementById('story-input').value;
        if(text.length < 5) return showView('view-home');
        const history = JSON.parse(localStorage.getItem('pRetroFinal') || '[]');
        history.unshift({ date: new Date().toLocaleDateString(), prompt: currentPrompt.content, text: text });
        localStorage.setItem('pRetroFinal', JSON.stringify(history));
        showHistory();
    }

    function showHistory() {
        showView('view-history');
        const list = document.getElementById('history-list');
        const history = JSON.parse(localStorage.getItem('pRetroFinal') || '[]');
        list.innerHTML = history.length ? history.map(item => `
            <div style="border-bottom: 1px solid var(--p-color); padding: 10px 0; margin-bottom: 10px; opacity: 0.8;">
                <small>${item.date}</small><br>
                <strong>> ${item.prompt}</strong><br>
                <p style="margin:5px 0 0 0; line-height: 1.4;">${item.text}</p>
            </div>
        `).join('') : "> AUCUNE_DATA_TROUVEE";
    }

    function clearArchives() {
        if(confirm("EFFACER TOUTES LES ARCHIVES DÃ‰FINITIVEMENT ?")) {
            localStorage.removeItem('pRetroFinal');
            showHistory();
        }
    }
</script>
</body>
</html>
